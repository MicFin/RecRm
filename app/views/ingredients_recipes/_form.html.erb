
<div class="form-group" id="ingredients-recipe-form">
  <%= simple_form_for @ingredients_recipe, :html => {:id => "ingredients-recipe-form-validate"}, remote: true  do |ingredients_recipe_form| %>
    <div id="errorBox">
      <%= devise_error_messages!(@ingredients_recipe) %>
    </div>
    <div class="form-group">
      <%= ingredients_recipe_form.input :amount %>
    </div>
    <div class="form-group">
      <%= ingredients_recipe_form.input :amount_unit, :collection => @units, :label => "Unit" ,:include_blank => false %>
    </div>
    <div class="form-group">
      <%= ingredients_recipe_form.fields_for :ingredient, @ingredient do |ingredient_form| %>
          <%= ingredient_form.input :name, :url => autocomplete_ingredient_name_recipes_path, :as => :autocomplete, input_html: {value: ingredient_form.object.name ||= nil} %>
      <% end %>
      <% if @recipe %>
        <%= ingredients_recipe_form.hidden_field :recipe_id, value: @recipe.id %>
      <% else %>
        <%= ingredients_recipe_form.hidden_field :recipe_id, value: params["recipe_id"].to_i %>
      <% end %>
    </div>
    <div class="actions">
      <%= ingredients_recipe_form.button :submit %>
    </div>
  <% end %>
</div>

<script src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.12.0/jquery.validate.js" type="text/javascript"></script>
<script>
$(document).ready(function() {
  $("#ingredients-recipe-form-validate").validate({
    rules: {
      "ingredients_recipe[ingredients_attribute][name]":{
        required: true,
        minlength: 2
      },
      "ingredients_recipe[amount]":{
        required: true,
        rangelength: [0, 100]
      }
    },
    messages: {
      "ingredients_recipe[ingredients_attribute][name]":{
        required: "Enter ingredient name",
        minlength: "Must be at least 2 letters"
      },
      "ingredients_recipe[amount]":{
        required: "Enter ingredient amount",
        minlength: "Must be between 0 and 100"
      }
    }
  });
});
</script>

