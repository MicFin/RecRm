
<div id="welcome-add-family" class="fork-background" >

	<div id="addFamilyModel" class="modal fade in" style="display: block;">
	  <div class="modal-dialog">
	    <div class="modal-content">

	      <div class="modal-body">
	       
	        <%= render "breadcrumbs" %>
	        <h1>Let's add a seat to your table!</h1>
	        <h4>For your first appointment, who's nutritional needs will we be focusing on?</h4>
					<div class="row">
		        <div class="form-group">
							<label class="radio-inline">
							  <input type="radio" name="appointment_focus" id="inlineRadio2" value="new-user-form">New Family Member
							</label>
							<label class="radio-inline">
								<% if @user.appointment_in_registration.patient_focus == @user %>
							  	<input type="radio" name="appointment_focus" id="inlineRadio1" value="user-form" checked>Mine (<%=@user.first_name%>)
							  	<% else %>
							  	<input type="radio" name="appointment_focus" id="inlineRadio1" value="user-form">Mine (<%=@user.first_name%>)
							  	<% end %>
							</label>
							<% if @family && @family.children %>
								<% @family.children.each.with_index(1) do |family_member, index| %>

									<label class="radio-inline" id="family-member-select-<%=family_member.id%>">

										<% if @user.appointment_in_registration.patient_focus == family_member %>
									  	<input type="radio" name="appointment_focus" id="inlineRadio<%=index+2%>" value="family-member-form-<%=index%>" checked><%=family_member.full_name%>
									  <% else %>
									  	<input type="radio" name="appointment_focus" id="inlineRadio<%=index+2%>" value="family-member-form-<%=index%>"><%=family_member.full_name%>
									  <% end %>
									</label>
								<% end %>
							<% end %>
						</div>
					</div>
					<%= simple_form_for(@user, :url => {:controller => 'welcome', :action => 'build_family'}, html: { method: :patch, class: 'col-xs-12 col-sm-10 col-sm-offset-1 text-left hidden user-form', role:"form" }) do |f| %>

						<%= render '/welcome/add_family/current_user_edit_info_form_fields', f: f %>
					  <div class="actions text-right">
					    <%= f.button :submit, "Next", class: "btn btn-primary btn-lg" %>
					  </div>
					<% end %>

					<% if @family && @family.children %>
						<% @family.children.each.with_index(1) do |family_member, index| %>
							<%= simple_form_for(family_member, :url => {:controller => 'welcome', :action => 'build_family'}, html: { method: :patch, class: "col-xs-12 col-sm-10 col-sm-offset-1 text-left hidden family-member-form-#{index}" , role:"form" }) do |f| %>

								<%= render '/welcome/add_family/current_user_edit_info_form_fields', {f: f, family_member: family_member, index: index}%>

							  <div class="actions text-right">
							  <%= link_to "delete family member", remove_family_member_path(@family, family_member), :confirm => "Are you sure you want to delete #{family_member.full_name}?", :method => :delete, remote: true %>
							    <%= f.button :submit, "Next", class: "btn btn-primary btn-lg" %>
							  </div>
							<% end %>
						<% end %>
					<% end %>

					<%= simple_form_for(@new_user, :url => {:controller => 'welcome', :action => 'build_family'}, html: { method: :patch, class: 'col-xs-12 col-sm-10 col-sm-offset-1 text-left hidden new-user-form', role:"form" }) do |f| %>
					


						<%= render '/welcome/add_family/new_user_edit_info_form_fields', f: f %>

					  <div class="actions text-right">
					    <%= f.button :submit, "Next", class: "btn btn-primary btn-lg" %>
					  </div>
					<% end %>
	      </div>
	      <div class="modal-footer">
	      </div>
	    </div><!-- /.modal-content -->
	  </div><!-- /.modal-dialog -->
	</div><!-- /.modal -->	
</div>


